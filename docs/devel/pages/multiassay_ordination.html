<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>21&nbsp; Ordination-based multiassay analysis – Orchestrating Microbiome Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../pages/integrated_learner.html" rel="next">
<link href="../pages/cross_correlation.html" rel="prev">
<link href="../assets/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar docked nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../assets/mia_logo.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Orchestrating Microbiome Analysis</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-bi-github">
<li>
    <a class="dropdown-item" href="https://github.com/microbiome/OMA/">
 <span class="dropdown-text">Source Code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://microbiome.github.io/OMA/docs/devel/">
 <span class="dropdown-text">Browse version <code>devel</code></span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../pages/cross_correlation.html">Multiomics</a></li><li class="breadcrumb-item"><a href="../pages/multiassay_ordination.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Ordination-based multiassay analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Microbiome data science in Bioconductor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/miaverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">miaverse</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Data containers &amp; importing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/containers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data containers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Import</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/convert.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Convert &amp; export</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Data wrangling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/taxonomy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Taxonomic information</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/subsetting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Subsetting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/agglomeration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Agglomeration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/transformation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Transformation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Exploration &amp; QC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/quality_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exploration &amp; quality control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/composition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Community composition</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Diversity &amp; similarity</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/alpha_diversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Community diversity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/beta_diversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Community similarity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Community typing</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Association</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/differential_abundance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Differential abundance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Correlation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Networks</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/network_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Network learning &amp; analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/network_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Network comparison</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Multiomics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/cross_correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Cross-association</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/multiassay_ordination.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Ordination-based multiassay analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/integrated_learner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Multi-omics prediction and classification</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Machine learning &amp; statistical modeling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/machine_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Machine learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/statistical_modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Statistical modeling</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Workflows</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/introductory_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Introductory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/introductory_workflow_french_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Introductory (French)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/introductory_workflow_dutch_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Introductory (Dutch)</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Training</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/training.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Training</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">Support &amp; resources</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/support.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Support</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/acknowledgments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Contributions</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/msea.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Microbe Set Enrichment Analysis (MSEA)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/mmuphin_meta_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Meta-analyses</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/extra_material.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Extra material</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/session_info.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Technical info</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#sec-mofa" id="toc-sec-mofa" class="nav-link active" data-scroll-target="#sec-mofa"><span class="header-section-number">21.1</span> Multi-Omics Factor Analysis</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../pages/cross_correlation.html">Multiomics</a></li><li class="breadcrumb-item"><a href="../pages/multiassay_ordination.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Ordination-based multiassay analysis</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-multiassay_ordination" class="quarto-section-identifier"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Ordination-based multiassay analysis</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="cell" data-layout-align="center">
<script>
document.addEventListener("click", function (event) {
    if (event.target.classList.contains("rebook-collapse")) {
        event.target.classList.toggle("active");
        var content = event.target.nextElementSibling;
        if (content.style.display === "block") {
            content.style.display = "none";
        } else {
            content.style.display = "block";
        }
    }
})
</script><style>
.rebook-collapse {
  background-color: #eee;
  color: #444;
  cursor: pointer;
  padding: 18px;
  width: 100%;
  border: none;
  text-align: left;
  outline: none;
  font-size: 15px;
}

.rebook-content {
  padding: 0 18px;
  display: none;
  overflow: hidden;
  background-color: #f1f1f1;
}
</style>
</div>
<p>In this chapter, we continue from where we left off in the previous section (referenced as <a href="cross_correlation.html#sec-cross-correlation" class="quarto-xref"><span>Section 20.1</span></a>). Specifically, we introduce an analytical method called Multi-Omics Factor Analysis. This method is described as “ordination-based,” meaning it involves techniques that reduce the dimensionality of the data while preserving as much variability as possible. Ordination methods are often used in multivariate analysis to visualize patterns, trends, and relationships in complex data sets, making them particularly useful for multi-omics data where multiple types of biological data are integrated and analyzed together.</p>
<p>See <a href="beta_diversity.html" class="quarto-xref"><span>Chapter 14</span></a> for more information on ordination methods.</p>
<section id="sec-mofa" class="level2 page-columns page-full" data-number="21.1"><h2 data-number="21.1" class="anchored" data-anchor-id="sec-mofa">
<span class="header-section-number">21.1</span> Multi-Omics Factor Analysis</h2>
<p>Multi-Omics Factor Analysis (MOFA) is an unsupervised method for integrating multi-omic data sets in a downstream analysis <span class="citation" data-cites="Argelaguet2018">(<a href="#ref-Argelaguet2018" role="doc-biblioref">Argelaguet 2018</a>)</span>. It could be seen as a generalization of principal component analysis. Yet, with the ability to infer a latent (low-dimensional) representation, shared among the multiple (-omics) data sets in hand.</p>
<div class="no-row-height column-margin column-container"><div id="ref-Argelaguet2018" class="csl-entry" role="listitem">
Argelaguet, Ricard et al. 2018. <span>“Multi-Omics Factor Analysis—a Framework for Unsupervised Integration of Multi-Omics Data Sets.”</span> <em>Molecular Systems Biology</em> 14 (6): e8124. <a href="https://doi.org/10.15252/msb.20178124">https://doi.org/10.15252/msb.20178124</a>.
</div></div><p>We use the R <a href="https://biofam.github.io/MOFA2/index.html">MOFA2</a> package for the analysis, and <a href="https://biofam.github.io/MOFA2/installation.html">install</a> the corresponding dependencies.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/microbiome/mia">mia</a></span><span class="op">)</span></span>
<span><span class="co"># Load the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">HintikkaXOData</span>, package <span class="op">=</span> <span class="st">"mia"</span><span class="op">)</span></span>
<span><span class="va">mae</span> <span class="op">&lt;-</span> <span class="va">HintikkaXOData</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>mae</code> object could be used straight to create the MOFA model. Yet, we transform our assays since the model assumes normality per default, and Gaussian model is recommended (see <a href="https://biofam.github.io/MOFA2/faq.html">MOFA2 FAQ</a>). However, Poisson and Bernoulli distribution models are also offered.</p>
<p>Note that duplicates, such as “uncultured”, might appear when aggregating the microbiome data by a taxonomic rank. To check for duplicates, run <code>any(duplicated(rownames(mae[[1]])))</code>. If it returns <code>TRUE</code>, then the duplicates are present. We can add <code>rownames(mae[[1]]) &lt;- getTaxonomyLabels(mae[[1]], make.unique=TRUE)</code> to remove them.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://biofam.github.io/MOFA2/index.html">MOFA2</a></span><span class="op">)</span></span>
<span><span class="co"># For simplicity, classify all high-fat diets as high-fat, and all the low-fat</span></span>
<span><span class="co"># diets as low-fat diets</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">Diet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">Diet</span> <span class="op">==</span> <span class="st">"High-fat"</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">Diet</span> <span class="op">==</span> <span class="st">"High-fat + XOS"</span>,</span>
<span>    <span class="st">"High-fat"</span>, <span class="st">"Low-fat"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Agglomerate microbiome data</span></span>
<span><span class="va">mae</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mia/man/agglomerateByPrevalence.html">agglomerateByPrevalence</a></span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, rank <span class="op">=</span> <span class="st">"Genus"</span><span class="op">)</span></span>
<span><span class="co"># Transforming microbiome data with clr and by scaling</span></span>
<span><span class="va">mae</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mia/man/transformAssay.html">transformAssay</a></span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"clr"</span>, pseudocount <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mae</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mia/man/transformAssay.html">transformAssay</a></span><span class="op">(</span></span>
<span>    <span class="va">mae</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, assay.type <span class="op">=</span> <span class="st">"clr"</span>, method <span class="op">=</span> <span class="st">"standardize"</span>, MARGIN <span class="op">=</span> <span class="st">"rows"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Transforming metabolomic data with log10 and by scaling</span></span>
<span><span class="va">mae</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mia/man/transformAssay.html">transformAssay</a></span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, assay.type <span class="op">=</span> <span class="st">"nmr"</span>, method <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span></span>
<span><span class="va">mae</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mia/man/transformAssay.html">transformAssay</a></span><span class="op">(</span></span>
<span>    <span class="va">mae</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, assay.type <span class="op">=</span> <span class="st">"log10"</span>, method <span class="op">=</span> <span class="st">"standardize"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Transforming biomarker data by scaling</span></span>
<span><span class="va">mae</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mia/man/transformAssay.html">transformAssay</a></span><span class="op">(</span></span>
<span>    <span class="va">mae</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, assay.type <span class="op">=</span> <span class="st">"signals"</span>, method <span class="op">=</span> <span class="st">"standardize"</span>, MARGIN <span class="op">=</span> <span class="st">"rows"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Removing the assays no longer needed</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="st">"standardize"</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="st">"standardize"</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="st">"standardize"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Building our mofa model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MOFA2/man/create_mofa_from_MultiAssayExperiment.html">create_mofa_from_MultiAssayExperiment</a></span><span class="op">(</span></span>
<span>    <span class="va">mae</span>,</span>
<span>    groups <span class="op">=</span> <span class="st">"Diet"</span>,</span>
<span>    extract_metadata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">model</span></span>
<span><span class="co">##  Untrained MOFA model with the following characteristics: </span></span>
<span><span class="co">##   Number of views: 3 </span></span>
<span><span class="co">##   Views names: microbiota metabolites biomarkers </span></span>
<span><span class="co">##   Number of features (per view): 112 38 39 </span></span>
<span><span class="co">##   Number of groups: 2 </span></span>
<span><span class="co">##   Groups names: High-fat Low-fat </span></span>
<span><span class="co">##   Number of samples (per group): 20 20 </span></span>
<span><span class="co">##  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Model options can be defined as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_opts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MOFA2/man/get_default_model_options.html">get_default_model_options</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">model_opts</span><span class="op">$</span><span class="va">num_factors</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">model_opts</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">##  $likelihoods</span></span>
<span><span class="co">##   microbiota metabolites  biomarkers </span></span>
<span><span class="co">##   "gaussian"  "gaussian"  "gaussian" </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $num_factors</span></span>
<span><span class="co">##  [1] 5</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $spikeslab_factors</span></span>
<span><span class="co">##  [1] FALSE</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $spikeslab_weights</span></span>
<span><span class="co">##  [1] FALSE</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $ard_factors</span></span>
<span><span class="co">##  [1] TRUE</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $ard_weights</span></span>
<span><span class="co">##  [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Training options for the model are defined in the following way:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">train_opts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MOFA2/man/get_default_training_options.html">get_default_training_options</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">train_opts</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">##  $maxiter</span></span>
<span><span class="co">##  [1] 1000</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $convergence_mode</span></span>
<span><span class="co">##  [1] "fast"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $drop_factor_threshold</span></span>
<span><span class="co">##  [1] -1</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $verbose</span></span>
<span><span class="co">##  [1] FALSE</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $startELBO</span></span>
<span><span class="co">##  [1] 1</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $freqELBO</span></span>
<span><span class="co">##  [1] 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The model is then prepared with <code><a href="https://rdrr.io/pkg/MOFA2/man/prepare_mofa.html">prepare_mofa()</a></code> and trained with <code><a href="https://rdrr.io/pkg/MOFA2/man/run_mofa.html">run_mofa()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MOFA2/man/prepare_mofa.html">prepare_mofa</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">model</span>,</span>
<span>  model_options <span class="op">=</span> <span class="va">model_opts</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Some systems may require the specification `use_basilisk = TRUE`</span></span>
<span><span class="co"># so it has been added to the following code</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MOFA2/man/run_mofa.html">run_mofa</a></span><span class="op">(</span><span class="va">model</span>, use_basilisk <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##          #########################################################</span></span>
<span><span class="co">##          ###           __  __  ____  ______                    ### </span></span>
<span><span class="co">##          ###          |  \/  |/ __ \|  ____/\    _             ### </span></span>
<span><span class="co">##          ###          | \  / | |  | | |__ /  \ _| |_           ### </span></span>
<span><span class="co">##          ###          | |\/| | |  | |  __/ /\ \_   _|          ###</span></span>
<span><span class="co">##          ###          | |  | | |__| | | / ____ \|_|            ###</span></span>
<span><span class="co">##          ###          |_|  |_|\____/|_|/_/    \_\              ###</span></span>
<span><span class="co">##          ###                                                   ### </span></span>
<span><span class="co">##          ######################################################### </span></span>
<span><span class="co">##         </span></span>
<span><span class="co">##   </span></span>
<span><span class="co">##          </span></span>
<span><span class="co">##  use_float32 set to True: replacing float64 arrays by float32 arrays to speed up computations...</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Successfully loaded view='microbiota' group='High-fat' with N=20 samples and D=112 features...</span></span>
<span><span class="co">##  Successfully loaded view='microbiota' group='Low-fat' with N=20 samples and D=112 features...</span></span>
<span><span class="co">##  Successfully loaded view='metabolites' group='High-fat' with N=20 samples and D=38 features...</span></span>
<span><span class="co">##  Successfully loaded view='metabolites' group='Low-fat' with N=20 samples and D=38 features...</span></span>
<span><span class="co">##  Successfully loaded view='biomarkers' group='High-fat' with N=20 samples and D=39 features...</span></span>
<span><span class="co">##  Successfully loaded view='biomarkers' group='Low-fat' with N=20 samples and D=39 features...</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Model options:</span></span>
<span><span class="co">##  - Automatic Relevance Determination prior on the factors: True</span></span>
<span><span class="co">##  - Automatic Relevance Determination prior on the weights: True</span></span>
<span><span class="co">##  - Spike-and-slab prior on the factors: False</span></span>
<span><span class="co">##  - Spike-and-slab prior on the weights: False</span></span>
<span><span class="co">##  Likelihoods:</span></span>
<span><span class="co">##  - View 0 (microbiota): gaussian</span></span>
<span><span class="co">##  - View 1 (metabolites): gaussian</span></span>
<span><span class="co">##  - View 2 (biomarkers): gaussian</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  ######################################</span></span>
<span><span class="co">##  ## Training the model with seed 42 ##</span></span>
<span><span class="co">##  ######################################</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  ELBO before training: -38460.42 </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Iteration 1: time=0.00, ELBO=-11274.06, deltaELBO=27186.360 (70.68659170%), Factors=5</span></span>
<span><span class="co">##  Iteration 2: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 3: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 4: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 5: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 6: time=0.00, ELBO=-9939.68, deltaELBO=1334.375 (3.46947657%), Factors=5</span></span>
<span><span class="co">##  Iteration 7: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 8: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 9: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 10: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 11: time=0.00, ELBO=-9863.77, deltaELBO=75.913 (0.19737939%), Factors=5</span></span>
<span><span class="co">##  Iteration 12: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 13: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 14: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 15: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 16: time=0.00, ELBO=-9832.74, deltaELBO=31.036 (0.08069500%), Factors=5</span></span>
<span><span class="co">##  Iteration 17: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 18: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 19: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 20: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 21: time=0.00, ELBO=-9801.57, deltaELBO=31.161 (0.08102186%), Factors=5</span></span>
<span><span class="co">##  Iteration 22: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 23: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 24: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 25: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 26: time=0.00, ELBO=-9793.82, deltaELBO=7.757 (0.02016822%), Factors=5</span></span>
<span><span class="co">##  Iteration 27: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 28: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 29: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 30: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 31: time=0.00, ELBO=-9790.66, deltaELBO=3.159 (0.00821374%), Factors=5</span></span>
<span><span class="co">##  Iteration 32: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 33: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 34: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 35: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 36: time=0.00, ELBO=-9788.54, deltaELBO=2.119 (0.00550859%), Factors=5</span></span>
<span><span class="co">##  Iteration 37: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 38: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 39: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 40: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 41: time=0.00, ELBO=-9786.85, deltaELBO=1.692 (0.00439837%), Factors=5</span></span>
<span><span class="co">##  Iteration 42: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 43: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 44: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 45: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 46: time=0.00, ELBO=-9785.32, deltaELBO=1.528 (0.00397286%), Factors=5</span></span>
<span><span class="co">##  Iteration 47: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 48: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 49: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 50: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 51: time=0.00, ELBO=-9783.93, deltaELBO=1.390 (0.00361446%), Factors=5</span></span>
<span><span class="co">##  Iteration 52: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 53: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 54: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 55: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 56: time=0.00, ELBO=-9782.78, deltaELBO=1.147 (0.00298238%), Factors=5</span></span>
<span><span class="co">##  Iteration 57: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 58: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 59: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 60: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 61: time=0.00, ELBO=-9781.88, deltaELBO=0.903 (0.00234912%), Factors=5</span></span>
<span><span class="co">##  Iteration 62: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 63: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 64: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 65: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 66: time=0.00, ELBO=-9781.15, deltaELBO=0.733 (0.00190536%), Factors=5</span></span>
<span><span class="co">##  Iteration 67: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 68: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 69: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 70: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 71: time=0.00, ELBO=-9780.52, deltaELBO=0.622 (0.00161814%), Factors=5</span></span>
<span><span class="co">##  Iteration 72: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 73: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 74: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 75: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 76: time=0.00, ELBO=-9779.98, deltaELBO=0.546 (0.00142075%), Factors=5</span></span>
<span><span class="co">##  Iteration 77: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 78: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 79: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 80: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 81: time=0.00, ELBO=-9779.49, deltaELBO=0.489 (0.00127231%), Factors=5</span></span>
<span><span class="co">##  Iteration 82: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 83: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 84: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 85: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 86: time=0.00, ELBO=-9779.04, deltaELBO=0.446 (0.00116022%), Factors=5</span></span>
<span><span class="co">##  Iteration 87: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 88: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 89: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 90: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 91: time=0.00, ELBO=-9778.63, deltaELBO=0.412 (0.00107075%), Factors=5</span></span>
<span><span class="co">##  Iteration 92: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 93: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 94: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 95: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 96: time=0.00, ELBO=-9778.25, deltaELBO=0.384 (0.00099829%), Factors=5</span></span>
<span><span class="co">##  Iteration 97: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 98: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 99: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 100: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 101: time=0.00, ELBO=-9777.89, deltaELBO=0.362 (0.00094041%), Factors=5</span></span>
<span><span class="co">##  Iteration 102: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 103: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 104: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 105: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 106: time=0.00, ELBO=-9777.54, deltaELBO=0.343 (0.00089062%), Factors=5</span></span>
<span><span class="co">##  Iteration 107: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 108: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 109: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 110: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 111: time=0.00, ELBO=-9777.22, deltaELBO=0.327 (0.00085053%), Factors=5</span></span>
<span><span class="co">##  Iteration 112: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 113: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 114: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 115: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 116: time=0.00, ELBO=-9776.90, deltaELBO=0.314 (0.00081733%), Factors=5</span></span>
<span><span class="co">##  Iteration 117: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 118: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 119: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 120: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 121: time=0.00, ELBO=-9776.60, deltaELBO=0.303 (0.00078783%), Factors=5</span></span>
<span><span class="co">##  Iteration 122: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 123: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 124: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 125: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 126: time=0.00, ELBO=-9776.30, deltaELBO=0.294 (0.00076567%), Factors=5</span></span>
<span><span class="co">##  Iteration 127: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 128: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 129: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 130: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 131: time=0.00, ELBO=-9776.02, deltaELBO=0.286 (0.00074251%), Factors=5</span></span>
<span><span class="co">##  Iteration 132: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 133: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 134: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 135: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 136: time=0.00, ELBO=-9775.74, deltaELBO=0.281 (0.00073046%), Factors=5</span></span>
<span><span class="co">##  Iteration 137: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 138: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 139: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 140: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 141: time=0.00, ELBO=-9775.46, deltaELBO=0.277 (0.00071921%), Factors=5</span></span>
<span><span class="co">##  Iteration 142: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 143: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 144: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 145: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 146: time=0.00, ELBO=-9775.19, deltaELBO=0.272 (0.00070694%), Factors=5</span></span>
<span><span class="co">##  Iteration 147: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 148: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 149: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 150: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 151: time=0.00, ELBO=-9774.92, deltaELBO=0.270 (0.00070197%), Factors=5</span></span>
<span><span class="co">##  Iteration 152: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 153: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 154: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 155: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 156: time=0.00, ELBO=-9774.65, deltaELBO=0.268 (0.00069757%), Factors=5</span></span>
<span><span class="co">##  Iteration 157: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 158: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 159: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 160: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 161: time=0.00, ELBO=-9774.38, deltaELBO=0.267 (0.00069391%), Factors=5</span></span>
<span><span class="co">##  Iteration 162: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 163: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 164: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 165: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 166: time=0.00, ELBO=-9774.12, deltaELBO=0.266 (0.00069097%), Factors=5</span></span>
<span><span class="co">##  Iteration 167: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 168: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 169: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 170: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 171: time=0.00, ELBO=-9773.85, deltaELBO=0.265 (0.00068801%), Factors=5</span></span>
<span><span class="co">##  Iteration 172: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 173: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 174: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 175: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 176: time=0.00, ELBO=-9773.59, deltaELBO=0.265 (0.00068873%), Factors=5</span></span>
<span><span class="co">##  Iteration 177: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 178: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 179: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 180: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 181: time=0.00, ELBO=-9773.33, deltaELBO=0.263 (0.00068332%), Factors=5</span></span>
<span><span class="co">##  Iteration 182: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 183: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 184: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 185: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 186: time=0.00, ELBO=-9773.06, deltaELBO=0.262 (0.00068149%), Factors=5</span></span>
<span><span class="co">##  Iteration 187: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 188: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 189: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 190: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 191: time=0.00, ELBO=-9772.80, deltaELBO=0.259 (0.00067342%), Factors=5</span></span>
<span><span class="co">##  Iteration 192: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 193: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 194: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 195: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 196: time=0.00, ELBO=-9772.55, deltaELBO=0.257 (0.00066771%), Factors=5</span></span>
<span><span class="co">##  Iteration 197: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 198: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 199: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 200: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 201: time=0.00, ELBO=-9772.30, deltaELBO=0.253 (0.00065654%), Factors=5</span></span>
<span><span class="co">##  Iteration 202: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 203: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 204: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 205: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 206: time=0.00, ELBO=-9772.05, deltaELBO=0.247 (0.00064343%), Factors=5</span></span>
<span><span class="co">##  Iteration 207: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 208: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 209: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 210: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 211: time=0.00, ELBO=-9771.81, deltaELBO=0.241 (0.00062637%), Factors=5</span></span>
<span><span class="co">##  Iteration 212: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 213: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 214: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 215: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 216: time=0.00, ELBO=-9771.57, deltaELBO=0.233 (0.00060504%), Factors=5</span></span>
<span><span class="co">##  Iteration 217: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 218: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 219: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 220: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 221: time=0.00, ELBO=-9771.35, deltaELBO=0.222 (0.00057816%), Factors=5</span></span>
<span><span class="co">##  Iteration 222: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 223: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 224: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 225: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 226: time=0.00, ELBO=-9771.14, deltaELBO=0.213 (0.00055305%), Factors=5</span></span>
<span><span class="co">##  Iteration 227: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 228: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 229: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 230: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 231: time=0.00, ELBO=-9770.94, deltaELBO=0.202 (0.00052452%), Factors=5</span></span>
<span><span class="co">##  Iteration 232: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 233: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 234: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 235: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 236: time=0.00, ELBO=-9770.75, deltaELBO=0.190 (0.00049300%), Factors=5</span></span>
<span><span class="co">##  Iteration 237: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 238: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 239: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 240: time=0.00, Factors=5</span></span>
<span><span class="co">##  Iteration 241: time=0.00, ELBO=-9770.57, deltaELBO=0.178 (0.00046309%), Factors=5</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Converged!</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  #######################</span></span>
<span><span class="co">##  ## Training finished ##</span></span>
<span><span class="co">##  #######################</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Saving model in /tmp/RtmpcbDybm/mofa_20241006-070020.hdf5...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The explained variance is visualized with the <code><a href="https://rdrr.io/pkg/MOFA2/man/plot_variance_explained.html">plot_variance_explained()</a></code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MOFA2/man/plot_variance_explained.html">plot_variance_explained</a></span><span class="op">(</span></span>
<span>    <span class="va">model</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"view"</span>, y <span class="op">=</span> <span class="st">"factor"</span>,</span>
<span>    plot_total <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html">wrap_plots</a></span><span class="op">(</span><span class="va">plot_list</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Variance Explained per factor and assay"</span>,</span>
<span>        theme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="multiassay_ordination_files/figure-html/mofa7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>From the plot, we can observe that the microbiota accounts for most of the variability in the data. Biomarkers do not significantly explain the variability. The variability in the microbiota is primarily captured in factors 1 and 2, while metabolites are primarily represented in factor 2.</p>
<p>We can then visualize the top weights for microbiota and metabolites for the first two factors to analyze co-varying features.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"microbiota"</span>, <span class="st">"metabolites"</span><span class="op">)</span>,</span>
<span>    <span class="va">plot_top_weights</span>,</span>
<span>    object <span class="op">=</span> <span class="va">model</span>,</span>
<span>    factors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    nfeatures <span class="op">=</span> <span class="fl">10</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html">wrap_plots</a></span><span class="op">(</span><span class="va">plot_list</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="multiassay_ordination_files/figure-html/mofa8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>From the visualization, we can see that glycerol, lactate, and choline are positively associated with factor 2, while acetate is negatively associated among the metabolites. In terms of microbiota, Ruminococcaceae and Ruminodostridium, for instance, are positively associated with the same factor. This indicates that these features co-vary in the data, suggesting a positive association with glycerol, lactate, and choline, and a negative association with acetate and these microbes.</p>
<p>More tutorials and examples of using the package are found at <a href="https://biofam.github.io/MOFA2/tutorials.html">MOFA2 tutorials</a>.</p>



</section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../pages/cross_correlation.html" class="pagination-link" aria-label="Cross-association">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Cross-association</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../pages/integrated_learner.html" class="pagination-link" aria-label="Multi-omics prediction and classification">
        <span class="nav-page-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Multi-omics prediction and classification</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="./">Orchestrating Microbiome Analysis with Bioconductor</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://github.com/js2264/BiocBook/">BiocBook</a> with <span class="emoji" data-emoji="heart">❤️</span></p>
</div>
  </div>
</footer>


</body></html>